<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Landmark Sampling Evaluation Curve (LaSEC) | Patterns of shape change for Caddo bottles recovered from the southern Caddo area</title>
  <meta name="description" content="Morphological analysis of Caddo bottles." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Landmark Sampling Evaluation Curve (LaSEC) | Patterns of shape change for Caddo bottles recovered from the southern Caddo area" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Morphological analysis of Caddo bottles." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Landmark Sampling Evaluation Curve (LaSEC) | Patterns of shape change for Caddo bottles recovered from the southern Caddo area" />
  
  <meta name="twitter:description" content="Morphological analysis of Caddo bottles." />
  

<meta name="author" content="Robert Z. Selden, Jr." />


<meta name="date" content="2021-02-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="landmarking-protocol.html"/>
<link rel="next" href="analysis-of-caddo-bottle-morphology.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">shape.change.1</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#primary-findings"><i class="fa fa-check"></i><b>0.1</b> Primary findings</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i><b>0.2</b> Acknowledgments</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#funding"><i class="fa fa-check"></i><b>0.3</b> Funding</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#data-management"><i class="fa fa-check"></i><b>0.4</b> Data management</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="landmarking-protocol.html"><a href="landmarking-protocol.html"><i class="fa fa-check"></i><b>1</b> Landmarking Protocol</a></li>
<li class="chapter" data-level="2" data-path="landmark-sampling-evaluation-curve-lasec.html"><a href="landmark-sampling-evaluation-curve-lasec.html"><i class="fa fa-check"></i><b>2</b> Landmark Sampling Evaluation Curve (LaSEC)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="landmark-sampling-evaluation-curve-lasec.html"><a href="landmark-sampling-evaluation-curve-lasec.html#analysis-of-experimental-sample"><i class="fa fa-check"></i><b>2.1</b> Analysis of experimental sample</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="analysis-of-caddo-bottle-morphology.html"><a href="analysis-of-caddo-bottle-morphology.html"><i class="fa fa-check"></i><b>3</b> Analysis of Caddo bottle morphology</a>
<ul>
<li class="chapter" data-level="3.1" data-path="analysis-of-caddo-bottle-morphology.html"><a href="analysis-of-caddo-bottle-morphology.html#load-packages-data"><i class="fa fa-check"></i><b>3.1</b> Load packages + data</a></li>
<li class="chapter" data-level="3.2" data-path="analysis-of-caddo-bottle-morphology.html"><a href="analysis-of-caddo-bottle-morphology.html#generalised-procrustes-analysis"><i class="fa fa-check"></i><b>3.2</b> Generalised Procrustes Analysis</a></li>
<li class="chapter" data-level="3.3" data-path="analysis-of-caddo-bottle-morphology.html"><a href="analysis-of-caddo-bottle-morphology.html#principal-components-analysis"><i class="fa fa-check"></i><b>3.3</b> Principal Components Analysis</a></li>
<li class="chapter" data-level="3.4" data-path="analysis-of-caddo-bottle-morphology.html"><a href="analysis-of-caddo-bottle-morphology.html#define-models"><i class="fa fa-check"></i><b>3.4</b> Define models</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="analysis-of-caddo-bottle-morphology.html"><a href="analysis-of-caddo-bottle-morphology.html#size-and-shape"><i class="fa fa-check"></i><b>3.4.1</b> Size and shape</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="analysis-of-caddo-bottle-morphology.html"><a href="analysis-of-caddo-bottle-morphology.html#test-hypothesis"><i class="fa fa-check"></i><b>3.5</b> Test Hypothesis</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="analysis-of-caddo-bottle-morphology.html"><a href="analysis-of-caddo-bottle-morphology.html#boxplot"><i class="fa fa-check"></i><b>3.5.1</b> Boxplot</a></li>
<li class="chapter" data-level="3.5.2" data-path="analysis-of-caddo-bottle-morphology.html"><a href="analysis-of-caddo-bottle-morphology.html#principal-components-analysis-1"><i class="fa fa-check"></i><b>3.5.2</b> Principal Components Analysis</a></li>
<li class="chapter" data-level="3.5.3" data-path="analysis-of-caddo-bottle-morphology.html"><a href="analysis-of-caddo-bottle-morphology.html#procrustes-anova"><i class="fa fa-check"></i><b>3.5.3</b> Procrustes ANOVA</a></li>
<li class="chapter" data-level="3.5.4" data-path="analysis-of-caddo-bottle-morphology.html"><a href="analysis-of-caddo-bottle-morphology.html#mean-shapes"><i class="fa fa-check"></i><b>3.5.4</b> Mean Shapes</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="analysis-of-caddo-bottle-morphology.html"><a href="analysis-of-caddo-bottle-morphology.html#trajectory-analysis"><i class="fa fa-check"></i><b>3.6</b> Trajectory analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Patterns of shape change for Caddo bottles recovered from the southern Caddo area</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="landmark-sampling-evaluation-curve-lasec" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> Landmark Sampling Evaluation Curve (LaSEC)</h1>
<p>The landmarking configuration used to analyse Caddo bottles was further scrutinised using the Landmark Sampling Error Curve, or <code>LaSEC</code> included in the <code>LaMBDA</code> package, as a means of assessing the fidelity of morphological characterisation by landmarks <span class="citation">(<a href="references.html#ref-RN28913" role="doc-biblioref">Watanabe 2018</a>)</span>, and was run after landmarking the entirety of the sample.</p>
<p>LaSEC conducts the following procedure <span class="citation">(<a href="references.html#ref-RN28913" role="doc-biblioref">Watanabe 2018, 4–5</a>)</span>:</p>
<ol style="list-style-type: decimal">
<li>As is typical for extracting shape data, perform a generalized Procrustes alignment (<code>gpagen</code> function in the <code>geomorph</code> package) on a coordinate dataset (argument <code>coord.data</code>) in 2-D or 3-D (argument <code>n.dim</code>) and record the resulting shape coordinates and centroid size. Here, the shape coordinates are projected onto tangent space because pairwise distances among corresponding datasets later in the analysis are based on Euclidean distances and most shape analyses in the biological literature are conducted in tangent space instead of Procrustes shape space.</li>
<li>Subsample the same three randomly selected landmarks from all specimens. The subsampling begins with a subset of three landmarks because a minimum of three landmarks is required to define shape. Then, generate shape and centroid size data with generalized Procrustes superimposition on the subsampled data.</li>
<li>Perform an Ordinary Procrustes Alignment (<code>protest</code> function in the <code>vegan</code> R package) on the subsampled data to minimize the pairwise distances between corresponding landmarks in the parent data through translation, rotation, and scaling of data in full shape space. As stated above, note that this procedure is different from the typical implementation of Procrustes alignment on coordinate data in 2-D or 3-D space. The function then records the sum of these squared distances as measure of fit (PSS) between the relative locations of data points in the parent and subsampled datasets. Equivalent procedure is conducted on centroid size data.</li>
<li>Sample one additional, randomly chosen landmark and repeat step 3 until the entire set of landmarks in the parent dataset is sampled. The completion of this step represents one iteration of subsampling.</li>
<li>Repeat steps 2–5 for specified number of iterations (<code>iter</code> argument).</li>
<li>Create sampling curves by plotting the trajectory of “fit” (1–PSS) against the number of landmarks sampled from each iteration for both shape and centroid size as gray lines. Then, plot the median fit value for each number of landmarks sampled on the same plot as a thick, dark line. Finally, output these sampling curves: <code>LaSEC_SamplingCurve_Shape.pdf</code>, <code>LaSEC_SamplingCurve_Size.pdf</code>.</li>
</ol>
<div id="analysis-of-experimental-sample" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Analysis of experimental sample</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load package</span></span>
<span id="cb2-2"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github(&quot;akiopteryx/lambda&quot;)</span></span>
<span id="cb2-3"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb2-4"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(LaMBDA)</span>
<span id="cb2-5"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;readmulti.csv.R&#39;</span>)</span>
<span id="cb2-7"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># read .csv files</span></span>
<span id="cb2-9"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;./data&quot;</span>)</span>
<span id="cb2-10"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-10" aria-hidden="true" tabindex="-1"></a>filelist <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">&quot;.csv&quot;</span>)</span>
<span id="cb2-11"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-11" aria-hidden="true" tabindex="-1"></a>lmdata <span class="ot">&lt;-</span> <span class="fu">readmulti.csv</span>(filelist)</span>
<span id="cb2-12"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-12" aria-hidden="true" tabindex="-1"></a>lmdata <span class="ot">&lt;-</span> <span class="fu">two.d.array</span>(lmdata)</span>
<span id="cb2-13"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;../&quot;</span>)</span>
<span id="cb2-14"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># analysis</span></span>
<span id="cb2-16"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lasec</span>(<span class="at">coord.data =</span> lmdata, </span>
<span id="cb2-17"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">n.dim =</span> <span class="dv">3</span>, </span>
<span id="cb2-18"><a href="landmark-sampling-evaluation-curve-lasec.html#cb2-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">1000</span>)</span></code></pre></div>
<p>Results demonstrate that nine landmarks are necessary to achieve a median fit value of 0.90, 13 to achieve a median fit value of 0.95, and 29 to achieve a fit value of 0.99. For centroid size, six landmarks were needed to achieve a median fit value of 0.99.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="landmark-sampling-evaluation-curve-lasec.html#cb3-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&#39;images/lasec.png&#39;</span>)</span></code></pre></div>
<div class="figure">
<img src="images/lasec.png" alt="Sampling curves from performing `LaSEC` on the dataset with respect to characterising shape variation. Each gray line indicates fit values from one iteration of subsampling. Thick, dark line denotes median fit value at each number of landmarks. `LaSEC` sampling curve for centroid size (left), and for shape (right). Results produced using the code above for this 3D dataset, using 1,000 iterations. _Images converted to PNG following export._" width="2162" />
<p class="caption">
(#fig:fig.lasec.EX)Sampling curves from performing <code>LaSEC</code> on the dataset with respect to characterising shape variation. Each gray line indicates fit values from one iteration of subsampling. Thick, dark line denotes median fit value at each number of landmarks. <code>LaSEC</code> sampling curve for centroid size (left), and for shape (right). Results produced using the code above for this 3D dataset, using 1,000 iterations. <em>Images converted to PNG following export.</em>
</p>
</div>
<p>Results demonstrate saltation, meaning that some landmarks are critical for capturing shape information <span class="citation">(<a href="references.html#ref-RN28913" role="doc-biblioref">Watanabe 2018</a>)</span>. Dynamic as Caddo bottles may be, that variation might be captured with a configuration of landmarks that employed fewer semilandmarks.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="landmarking-protocol.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analysis-of-caddo-bottle-morphology.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["supp.pdf", "supp.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
